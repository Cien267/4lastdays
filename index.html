<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Work Time Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body
    class="bg-slate-900 text-slate-100 min-h-screen flex items-center justify-center p-6"
  >
    <div class="w-full max-w-4xl space-y-6">
      <!-- Header -->
      <div class="text-center">
        <h1 class="text-3xl font-bold">⏱ Work Time Tracker</h1>
        <p class="text-slate-400 mt-1">
          Mục tiêu: 8 giờ/ngày · 4 ngày liên tục
        </p>
      </div>

      <!-- Overall Progress -->
      <div class="bg-slate-800 rounded-xl p-5 shadow">
        <div class="flex justify-between mb-2">
          <span class="font-semibold">Tổng tiến độ (32 giờ)</span>
          <span id="totalText" class="text-sm text-slate-300"></span>
        </div>
        <div class="w-full bg-slate-700 rounded-full h-4">
          <div
            id="totalBar"
            class="bg-emerald-500 h-4 rounded-full transition-all"
          ></div>
        </div>
      </div>

      <!-- Input -->
      <div class="bg-slate-800 rounded-xl p-5 shadow space-y-4">
        <div class="grid grid-cols-1 md:grid-cols-4 gap-3">
          <input
            id="minutesInput"
            type="number"
            min="0"
            placeholder="Phút"
            class="rounded-lg bg-slate-700 px-3 py-2 focus:outline-none"
          />

          <input
            id="hoursInput"
            type="number"
            min="0"
            step="0.1"
            placeholder="Giờ"
            class="rounded-lg bg-slate-700 px-3 py-2 focus:outline-none"
          />

          <select
            id="daySelect"
            class="rounded-lg bg-slate-700 px-3 py-2 focus:outline-none"
          ></select>

          <button
            onclick="addTime()"
            class="bg-emerald-500 hover:bg-emerald-400 text-slate-900 font-semibold rounded-lg px-4"
          >
            ➕ Add time
          </button>
        </div>
        <p class="text-sm text-slate-400">
          * Có thể nhập phút <b>hoặc</b> giờ (hoặc cả hai)
        </p>
      </div>

      <!-- Days -->
      <div
        id="daysContainer"
        class="grid grid-cols-1 md:grid-cols-2 gap-4"
      ></div>
    </div>

    <script>
      const DAILY_TARGET = 480 // minutes
      const DAYS = 4
      const STORAGE_KEY = "work-tracker"

      function formatDateLocal(date) {
        const y = date.getFullYear()
        const m = String(date.getMonth() + 1).padStart(2, "0")
        const d = String(date.getDate()).padStart(2, "0")
        return `${y}-${m}-${d}`
      }

      const startDate = new Date()
      startDate.setHours(0, 0, 0, 0)

      let data = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {}

      function initDays() {
        const container = document.getElementById("daysContainer")
        const select = document.getElementById("daySelect")

        for (let i = 0; i < DAYS; i++) {
          const d = new Date(startDate)
          d.setDate(startDate.getDate() + i)
          const key = formatDateLocal(d)

          if (!data[key]) data[key] = 0

          // select
          const opt = document.createElement("option")
          opt.value = key
          opt.textContent = `Day ${i + 1} · ${key}`
          select.appendChild(opt)

          // card
          const card = document.createElement("div")
          card.className = "bg-slate-800 rounded-xl p-5 shadow space-y-2"
          card.id = `card-${key}`

          card.innerHTML = `
      <div class="flex justify-between">
        <span class="font-semibold">Day ${i + 1}</span>
        <span id="text-${key}" class="text-sm text-slate-300"></span>
      </div>
      <div class="w-full bg-slate-700 rounded-full h-3">
        <div id="bar-${key}" class="bg-sky-500 h-3 rounded-full transition-all"></div>
      </div>
    `

          container.appendChild(card)
        }

        updateUI()
      }

      function addTime() {
        const minutes = parseInt(minutesInput.value || 0)
        const hours = parseFloat(hoursInput.value || 0)
        const day = daySelect.value

        const totalMinutes = minutes + hours * 60
        if (totalMinutes <= 0) return

        data[day] += totalMinutes
        localStorage.setItem(STORAGE_KEY, JSON.stringify(data))

        minutesInput.value = ""
        hoursInput.value = ""

        updateUI()
      }

      function updateUI() {
        let total = 0

        Object.keys(data).forEach((key) => {
          const worked = data[key]
          total += worked

          const percent = Math.min((worked / DAILY_TARGET) * 100, 100)

          document.getElementById(`bar-${key}`).style.width = percent + "%"
          document.getElementById(`text-${key}`).textContent =
            `${(worked / 60).toFixed(2)} / 8 giờ`
        })

        const totalPercent = Math.min(
          (total / (DAILY_TARGET * DAYS)) * 100,
          100,
        )
        totalBar.style.width = totalPercent + "%"
        totalText.textContent = `${(total / 60).toFixed(2)} / 32 giờ`
      }

      initDays()
    </script>
  </body>
</html>
